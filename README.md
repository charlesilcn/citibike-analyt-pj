# Citi Bike 数据分析项目

## 项目概述

本项目对 Citi Bike 共享单车系统的数据进行全面分析，涵盖时间维度、空间维度和用户行为维度等多个方面。通过对 2023-2025 年的数据进行清洗、合并和深入分析，我们旨在理解共享单车的使用模式、高峰时段、热门站点以及用户行为特征，为 Citi Bike 系统的优化提供数据支持和业务建议。

## 文件目录结构

```
d:\code\502\Bike A/
├── Rdata/                 # 原始数据目录
│   ├── 23/                # 2023年原始数据
│   ├── 24/                # 2024年原始数据
│   └── 25/                # 2025年原始数据
├── merged_data/           # 合并和清洗后的数据
│   ├── merged_2023_data.csv
│   ├── merged_2024_data.csv
│   ├── merged_2025_data.csv
│   ├── cleaned_2023_data.csv
│   ├── cleaned_2024_data.csv
│   └── cleaned_2025_data.csv
├── result/                # 分析结果和报告
│   ├── 23/                # 2023年分析结果
│   ├── 24/                # 2024年分析结果
│   └── 25/                # 2025年分析结果
│       ├── analysis_results.json
│       ├── analysis_summary_report.md
│       └── visualizations/  # 可视化图表
├── 23cleaning_log.txt     # 2023年数据清洗日志
├── 24cleaning_log.txt     # 2024年数据清洗日志
├── 25cleaning_log.txt     # 2025年数据清洗日志
├── analyze_csv.py         # CSV分析脚本
├── clean_csv.py           # 数据清洗脚本
├── data_analysis.py       # 主要数据分析脚本
├── merge_csv.py           # CSV文件合并脚本
├── requirements.txt       # 项目依赖包列表
└── README.md              # 项目说明文档
```

## 代码功能说明

### 1. 数据处理流程

#### merge_csv.py
- **功能**：将指定目录下的多个CSV文件合并为单个文件
- **主要函数**：`merge_csv_files()` - 遍历目录中的所有CSV文件，读取并合并数据
- **输出**：合并后的CSV文件（如merged_2024_data.csv）

#### clean_csv.py
- **功能**：对合并后的数据进行清洗，处理异常值、缺失值和数据类型转换
- **主要步骤**：
  - 删除重复行
  - 转换和验证日期时间列
  - 筛选合理的骑行时长（1分钟到24小时）
  - 处理地理位置异常值
  - 处理缺失的站点信息
  - 验证用户类型和车辆类型
- **输出**：清洗后的数据文件（如cleaned_2024_data.csv）和清洗日志

#### data_analysis.py
- **功能**：对清洗后的数据进行多维度分析，生成可视化图表和分析报告
- **主要类**：`BikeDataAnalyzer` - 包含数据加载、预处理、分析和可视化的完整功能
- **主要分析维度**：
  - 时间维度分析：每日高峰时段、工作日vs周末比较、月度趋势
  - 空间维度分析：热门起点/终点、站点使用模式
  - 用户行为分析：骑行时长分布、用户类型（会员vs临时用户）行为差异
  - 车型维度分析：不同车型的使用情况比较

### 2. 数据分析功能

`BikeDataAnalyzer` 类的主要方法：

- `load_data()` - 加载数据，支持大数据集采样
- `preprocess_data()` - 数据预处理，包括特征提取和异常值处理
- `analyze_time_dimension()` - 时间维度分析
- `analyze_space_dimension()` - 空间维度分析
- `analyze_user_behavior()` - 用户行为分析
- `analyze_vehicle_type()` - 车型分析
- `generate_report()` - 生成分析报告
- `save_figure()` - 保存可视化图表

## 项目依赖

项目所需的主要Python包已在requirements.txt中列出，包括：
- pandas - 数据处理和分析
- numpy - 数值计算
- matplotlib - 数据可视化
- seaborn - 高级统计图表
- geopy - 地理距离计算

## 使用方法

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **数据处理流程**
   - 首先修改 `merge_csv.py` 中的 `source_dir` 和 `output_file` 变量，设置正确的源目录和输出文件路径
   - 运行合并脚本：`python merge_csv.py`
   - 修改 `clean_csv.py` 中的 `input_file` 和 `output_file` 变量，指向合并后的数据文件
   - 运行清洗脚本：`python clean_csv.py`
   - 修改 `data_analysis.py` 中的 `DEFAULT_CONFIG` 字典，设置正确的输入文件路径
   - 运行分析脚本：`python data_analysis.py`

3. **分析结果查看**
   - 分析报告将保存在 `result/年份/analysis_summary_report.md`
   - 可视化图表将保存在 `result/年份/visualizations/` 目录中
   - 详细的分析数据将保存在 `result/年份/analysis_results.json`

## Citi Bike 现状分析

### 当前状况

Citi Bike 作为纽约市主要的共享单车系统，目前面临以下几个方面的挑战：

1. **车辆分布不均** - 高峰时段部分热门区域站点常出现无车可用或满站无法还车的情况
2. **用户体验差异** - 会员和临时用户的使用模式存在明显差异，需要针对性优化
3. **季节性波动** - 使用率受季节和天气影响较大，资源配置需要动态调整
4. **运营效率** - 车辆调度成本高，需要更智能的预测和调度策略

### 改进建议

### 1. 车辆调度策略优化

- **AI预测模型实施** - 开发基于机器学习的需求预测模型，整合历史数据、天气预报、日历事件和交通流量等多维度数据，实现未来24-72小时的精确需求预测
- **动态阈值调度系统** - 根据实时使用率数据，为不同站点设置动态车辆数量阈值，当低于/高于阈值时自动生成调度工单
- **调度效率提升** - 
  - 实施"区域平衡"策略，将相邻区域视为一个整体进行调度优化
  - 开发调度员移动应用，提供智能路线规划和实时任务分配
  - 考虑引入自动驾驶或半自动驾驶的车辆调度系统，降低人力成本
- **季节性和天气应对策略** - 
  - 根据不同季节和天气条件，制定差异化的车辆部署计划
  - 极端天气前提前调整车辆分布，减少系统中断风险

### 2. 用户策略优化

- **分层会员体系** - 
  - 推出基础、高级和专业三个会员等级，提供差异化服务
  - 为高级会员提供每月固定骑行次数后折扣、优先预约等特权
- **动态定价机制** - 
  - 工作日早晚高峰（7-9点，17-19点）实施10-20%的时段溢价
  - 热门区域和时段的定价调整，通过价格杠杆平衡供需
  - 非高峰时段（夜间和周末）推出折扣活动，鼓励错峰用车
- **用户行为激励** - 
  - 开发积分奖励系统，用户在高峰期帮助车辆再平衡可获得额外积分
  - 实施"绿色骑行"计划，鼓励短途骑行替代短途驾车
- **用户体验优化** - 
  - 升级APP，提供更准确的车辆可用性预测和到达时间估算
  - 为首次使用用户提供引导教程，降低使用门槛

### 3. 站点优化

- **数据驱动的站点规划** - 
  - 基于聚类分析识别需求热点，优化站点分布
  - 对低使用率站点进行重新评估和调整，将资源集中在高效区域
- **智能基础设施升级** - 
  - 逐步将传统站点升级为智能站点，提供实时状态监控
  - 在主要站点安装天气防护设施，提高极端天气下的可用性
  - 部分大型站点增设电子显示屏，显示实时车辆信息和周边交通状况
- **多模式交通整合** - 
  - 与公共交通系统深度整合，在地铁和公交线路站点300米范围内增设共享单车站点
  - 开发"一站式"APP，整合多种交通方式的路线规划
  - 考虑与网约车平台合作，解决"最后一公里"问题
- **未来扩展建议** - 
  - 探索无桩式共享单车技术，提高系统灵活性
  - 在商业中心和住宅区增设电动车充电站，支持电动共享单车型号扩展

## 结论

通过对Citi Bike数据的全面分析，我们发现了系统运营中的关键模式和潜在优化空间。通过实施智能调度、个性化用户策略和站点优化，可以显著提升系统效率、用户体验和整体盈利能力。建议Citi Bike团队将数据分析结果与业务决策紧密结合，持续优化系统运营，为城市绿色出行提供更高效的解决方案。
